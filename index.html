<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeSphere - The Ultimate Online Compiler</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .logo-icon {
            font-size: 2rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transform: rotate(5deg);
            transition: transform 0.3s;
        }

        .logo-icon:hover {
            transform: rotate(0deg) scale(1.1);
        }

        .logo-text h1 {
            font-size: 1.8rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }

        .logo-text p {
            font-size: 0.8rem;
            color: #666;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            transition: width 0.3s;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 4rem 2rem;
            color: white;
            background: rgba(0, 0, 0, 0.1);
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            animation: fadeInUp 1s ease;
        }

        .hero p {
            font-size: 1.3rem;
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto 2rem;
            animation: fadeInUp 1s ease 0.2s both;
        }

        .hero-badges {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            animation: fadeInUp 1s ease 0.4s both;
        }

        .badge {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 0.8rem 1.5rem;
            border-radius: 40px;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        /* Feature Cards */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            animation: fadeInUp 1s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.15);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
        }

        .feature-card p {
            color: #666;
            font-size: 0.95rem;
        }

        /* Compiler Section */
        .compiler-section {
            background: white;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
            margin-bottom: 3rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .compiler-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 1.5rem 2rem;
            color: white;
        }

        .compiler-header h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .compiler-header p {
            opacity: 0.95;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 1rem;
            padding: 1.5rem 2rem;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .tab-btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            color: #64748b;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        /* Language Info */
        .language-info {
            padding: 1.5rem 2rem;
            background: #f1f5f9;
        }

        .info-box {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .info-box p {
            color: #475569;
            font-size: 0.95rem;
        }

        /* Language Selector */
        .language-selector {
            display: flex;
            gap: 0.8rem;
            padding: 1.5rem 2rem;
            flex-wrap: wrap;
            background: white;
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #667eea #e2e8f0;
        }

        .language-selector::-webkit-scrollbar {
            width: 8px;
        }

        .language-selector::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 10px;
        }

        .language-selector::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
        }

        .lang-btn {
            padding: 0.7rem 1.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 30px;
            background: white;
            color: #475569;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .lang-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            color: white;
        }

        /* Editor Toolbar */
        .editor-toolbar {
            display: flex;
            gap: 0.5rem;
            padding: 0 2rem;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }

        .toolbar-btn {
            padding: 0.5rem 1rem;
            border: none;
            background: none;
            color: #64748b;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .toolbar-btn:hover {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .toolbar-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        /* Editor */
        .editor-wrapper {
            padding: 2rem;
        }

        .editor-container {
            background: #1e1e1e;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid #333;
        }

        .editor-header {
            background: #2d2d2d;
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #404040;
        }

        .editor-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .editor-title h3 {
            font-size: 1rem;
            font-weight: 500;
        }

        .version-badge {
            background: #667eea;
            padding: 0.2rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        #code-editor {
            width: 100%;
            height: 400px;
            background: #1e1e1e;
            border: none;
            color: #d4d4d4;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            padding: 1.5rem;
            resize: vertical;
            outline: none;
        }

        /* IO Section */
        .io-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            padding: 2rem;
            background: #f8fafc;
        }

        .io-box {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .io-header {
            background: #f1f5f9;
            padding: 1rem 1.5rem;
            font-weight: 600;
            color: #475569;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.5rem;
        }

        .io-actions {
            display: flex;
            gap: 0.5rem;
        }

        .io-action-btn {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .io-action-btn:hover {
            background: #e2e8f0;
            color: #667eea;
        }

        .io-content {
            padding: 1.5rem;
        }

        #stdin-input {
            width: 100%;
            height: 200px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            font-family: monospace;
            resize: vertical;
            font-size: 14px;
        }

        #stdin-input:focus {
            outline: 2px solid #667eea;
            border-color: transparent;
        }

        .output-area {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 1rem;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            color: #d4d4d4;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.6;
        }

        .output-success {
            color: #10b981;
        }

        .output-error {
            color: #ef4444;
        }

        .output-warning {
            color: #f59e0b;
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 1rem;
            padding: 2rem;
            justify-content: center;
            background: white;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 40px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.8rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Preview Section */
        .preview-section {
            padding: 2rem;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .preview-header h3 {
            color: #475569;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-controls {
            display: flex;
            gap: 0.5rem;
        }

        .preview-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.9rem;
        }

        .preview-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .preview-container {
            position: relative;
            width: 100%;
            height: 400px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .preview-container.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1000;
            border-radius: 0;
        }

        #preview {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        /* Tabs Container */
        .tabs-container {
            display: flex;
            background: #f1f5f9;
            border-bottom: 1px solid #e2e8f0;
            overflow-x: auto;
            scrollbar-width: thin;
        }

        .editor-tab {
            padding: 0.8rem 1.5rem;
            background: transparent;
            border: none;
            border-right: 1px solid #e2e8f0;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #64748b;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .editor-tab:hover {
            background: #e2e8f0;
        }

        .editor-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 2px solid #667eea;
        }

        .editor-tab-close {
            margin-left: 0.5rem;
            opacity: 0.5;
            transition: opacity 0.3s;
        }

        .editor-tab-close:hover {
            opacity: 1;
        }

        .new-tab-btn {
            padding: 0.8rem 1rem;
            background: transparent;
            border: none;
            cursor: pointer;
            color: #64748b;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .new-tab-btn:hover {
            color: #667eea;
        }

        /* Stats Section */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: #64748b;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        /* FAQ Section */
        .faq-section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin: 3rem 0;
        }

        .faq-section h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: #333;
        }

        .faq-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
        }

        .faq-item {
            padding: 1.5rem;
            background: #f8fafc;
            border-radius: 12px;
        }

        .faq-item h4 {
            color: #333;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .faq-item p {
            color: #64748b;
            font-size: 0.95rem;
        }

        /* Footer */
        .footer {
            background: #1e293b;
            color: white;
            padding: 3rem 2rem;
            margin-top: 3rem;
            border-radius: 30px 30px 0 0;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 3rem;
        }

        .footer-section h4 {
            margin-bottom: 1rem;
            color: #94a3b8;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section ul li a {
            color: #cbd5e1;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-section ul li a:hover {
            color: #667eea;
        }

        .footer-bottom {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #334155;
            color: #94a3b8;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1000;
            border-left: 4px solid #667eea;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #ef4444;
        }

        .toast.warning {
            border-left-color: #f59e0b;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .io-section {
                grid-template-columns: 1fr;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .nav {
                flex-direction: column;
                gap: 1rem;
            }
            
            .stats-section {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .faq-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .preview-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav">
            <div class="logo">
                <div class="logo-icon">‚ö°</div>
                <div class="logo-text">
                    <h1>CodeSphere</h1>
                    <p>Compile anything, anywhere</p>
                </div>
            </div>
            <div class="nav-links">
                <a href="#features">Features</a>
                <a href="#compiler">Compiler</a>
                <a href="#faq">FAQ</a>
                <a href="#contact">Contact</a>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <h1>The Ultimate Online Compiler</h1>
        <p>Write, compile, and run code in 15+ programming languages directly in your browser. No setup, no installations, just pure coding.</p>
        <div class="hero-badges">
            <span class="badge">üêç Python 3.10</span>
            <span class="badge">‚òï Java 15.0.2</span>
            <span class="badge">‚ö° C++ 14</span>
            <span class="badge">‚ö° C 11</span>
            <span class="badge">üåê HTML5</span>
            <span class="badge">üé® CSS3</span>
            <span class="badge">‚ö° JavaScript ES6</span>
            <span class="badge">üíé Ruby 3.0.1</span>
            <span class="badge">üîµ Go 1.16.4</span>
            <span class="badge">ü¶Ä Rust 1.68.2</span>
            <span class="badge">üêò PHP 8.2.3</span>
            <span class="badge">üìò TypeScript 5.0.3</span>
            <span class="badge">#Ô∏è‚É£ C# 10.0</span>
            <span class="badge">‚ö° Swift 5.3.3</span>
            <span class="badge">üî∑ R 4.1.2</span>
        </div>
    </section>

    <!-- Main Container -->
    <div class="container">
        <!-- Features Grid -->
        <div class="features-grid" id="features">
            <div class="feature-card">
                <div class="feature-icon">üöÄ</div>
                <h3>Instant Compilation</h3>
                <p>Compile and run your code instantly with our powerful cloud-based engine. Get results in milliseconds.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üîí</div>
                <h3>Secure Execution</h3>
                <p>Your code runs in isolated containers, ensuring complete security and privacy for your programs.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üì±</div>
                <h3>Live Preview</h3>
                <p>See your HTML, CSS, and JavaScript changes in real-time with our live preview feature.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üíæ</div>
                <h3>Auto Save</h3>
                <p>Never lose your work. Your code is automatically saved in your browser's local storage.</p>
            </div>
        </div>

        <!-- Compiler Section -->
        <div class="compiler-section" id="compiler">
            <div class="compiler-header">
                <h2>‚ö° Online Compiler</h2>
                <p>Choose your language, write code, and see the output instantly</p>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchMode('web', event)">üåê Web Development</button>
                <button class="tab-btn" onclick="switchMode('lang', event)">‚öôÔ∏è Programming Languages</button>
            </div>

            <!-- Language Info -->
            <div class="language-info" id="language-info">
                <div class="info-box">
                    <p>üí° <strong>Web Development Mode:</strong> Write HTML, CSS, and JavaScript with live preview. Perfect for building and testing web pages.</p>
                </div>
            </div>

            <!-- Language Selector -->
            <div class="language-selector" id="lang-selector"></div>

            <!-- Editor Tabs -->
            <div class="tabs-container" id="editor-tabs-container">
                <button class="editor-tab active" data-tab="main">
                    <span id="editor-tab-icon">üåê</span>
                    <span id="editor-tab-name">main.html</span>
                </button>
                <button class="new-tab-btn" onclick="createNewTab()">
                    <span>‚ûï</span> New Tab
                </button>
            </div>

            <!-- Editor Toolbar -->
            <div class="editor-toolbar">
                <button class="toolbar-btn active" onclick="switchEditorView('editor')">üìù Editor</button>
                <button class="toolbar-btn" onclick="switchEditorView('both')">üîÑ Split View</button>
                <button class="toolbar-btn" onclick="switchEditorView('preview')">üëÅÔ∏è Preview Only</button>
            </div>

            <!-- Editor -->
            <div class="editor-wrapper" id="editor-wrapper">
                <div class="editor-container">
                    <div class="editor-header">
                        <div class="editor-title">
                            <span id="editor-icon">üåê</span>
                            <h3 id="editor-title">HTML Editor</h3>
                        </div>
                        <span class="version-badge" id="version-badge">HTML5</span>
                    </div>
                    <textarea id="code-editor" placeholder="Write your code here..." spellcheck="false"></textarea>
                </div>
            </div>

            <!-- Input/Output Section -->
            <div class="io-section">
                <div class="io-box">
                    <div class="io-header">
                        <span>üì•</span> Standard Input (stdin)
                        <div class="io-actions">
                            <button class="io-action-btn" onclick="clearStdin()" title="Clear Input">üóëÔ∏è</button>
                            <button class="io-action-btn" onclick="pasteStdin()" title="Paste">üìã</button>
                        </div>
                    </div>
                    <div class="io-content">
                        <textarea id="stdin-input" placeholder="Enter input for your program here..."></textarea>
                    </div>
                </div>
                <div class="io-box">
                    <div class="io-header">
                        <span>üì§</span> Program Output
                        <div class="io-actions">
                            <button class="io-action-btn" onclick="copyOutput()" title="Copy Output">üìã</button>
                            <button class="io-action-btn" onclick="clearOutput()" title="Clear Output">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="io-content">
                        <div class="output-area" id="output">// Ready to compile. Click Run to execute your code.</div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <button class="btn btn-primary" id="run-btn" onclick="runCode()">
                    <span>‚ñ∂</span> Run Code
                </button>
                <button class="btn btn-secondary" onclick="clearCode()">
                    <span>üóëÔ∏è</span> Clear
                </button>
                <button class="btn btn-secondary" onclick="loadHelloWorld()">
                    <span>üëã</span> Hello World
                </button>
                <button class="btn btn-secondary" onclick="loadSample()">
                    <span>üìã</span> Load Example
                </button>
                <button class="btn btn-secondary" onclick="formatCode()">
                    <span>‚ú®</span> Format
                </button>
            </div>

            <!-- Live Preview (Web Mode) -->
            <div class="preview-section" id="preview-section">
                <div class="preview-header">
                    <h3><span>üåê</span> Live Preview</h3>
                    <div class="preview-controls">
                        <span class="version-badge" id="preview-status">Ready</span>
                        <button class="preview-btn" onclick="refreshPreview()" title="Refresh Preview">
                            <span>üîÑ</span> Refresh
                        </button>
                        <button class="preview-btn" onclick="toggleFullscreen()" title="Toggle Fullscreen">
                            <span>‚õ∂</span> Fullscreen
                        </button>
                        <button class="preview-btn" onclick="openPreviewInNewTab()" title="Open in New Tab">
                            <span>üîó</span> New Tab
                        </button>
                    </div>
                </div>
                <div class="preview-container" id="preview-container">
                    <iframe id="preview" title="Live Preview" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>
                </div>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-number">15+</div>
                <div class="stat-label">Programming Languages</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">2M+</div>
                <div class="stat-label">Compilations Daily</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">100K+</div>
                <div class="stat-label">Active Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">99.9%</div>
                <div class="stat-label">Uptime</div>
            </div>
        </div>

        <!-- FAQ Section -->
        <div class="faq-section" id="faq">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h4><span>‚ùì</span> Is it really free?</h4>
                    <p>Yes! CodeSphere is completely free for all users. No hidden charges or premium features.</p>
                </div>
                <div class="faq-item">
                    <h4><span>‚ùì</span> What languages are supported?</h4>
                    <p>We support Python, Java, C++, C, PHP, Ruby, Go, Rust, TypeScript, C#, Swift, R, plus HTML, CSS, and JavaScript.</p>
                </div>
                <div class="faq-item">
                    <h4><span>‚ùì</span> Do I need to install anything?</h4>
                    <p>No installation needed! Everything runs in your browser. Just open the website and start coding.</p>
                </div>
                <div class="faq-item">
                    <h4><span>‚ùì</span> Is my code saved?</h4>
                    <p>Your code is automatically saved in your browser's local storage. You can also manually save it.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer" id="contact">
        <div class="footer-content">
            <div class="footer-section">
                <h4>CodeSphere</h4>
                <p>The ultimate online compiler for developers. Write, compile, and run code in your browser.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#compiler">Compiler</a></li>
                    <li><a href="#faq">FAQ</a></li>
                    <li><a href="#">Documentation</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Connect With Us</h4>
                <ul>
                    <li><a href="#">GitHub</a></li>
                    <li><a href="#">Twitter</a></li>
                    <li><a href="#">Discord</a></li>
                    <li><a href="#">Email</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2024 CodeSphere. Made with ‚ù§Ô∏è for developers worldwide</p>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span id="toast-icon">‚ÑπÔ∏è</span>
        <span id="toast-message"></span>
    </div>

    <script>
        // Language configurations with Piston API support
        const languages = {
            // Web Dev Languages
            html: {
                name: 'HTML',
                icon: 'üåê',
                version: 'HTML5',
                mode: 'web',
                language: 'html',
                extension: 'html',
                description: 'HTML (HyperText Markup Language) is the standard markup language for creating web pages.',
                commonUse: 'Building web pages structure, creating forms, embedding media, semantic markup.',
                sample: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My First Web Page</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
        }
        .card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 400px;
        }
        h1 {
            color: #667eea;
            margin-bottom: 20px;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        button:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>üöÄ Welcome to CodeSphere!</h1>
        <p>This is a live HTML preview with embedded CSS.</p>
        <button onclick="alert('Hello from CodeSphere!')">Click Me</button>
    </div>
</body>
</html>`,
                helloWorld: `<!DOCTYPE html>
<html>
<head>
    <title>Hello World</title>
</head>
<body>
    <h1>Hello, World!</h1>
    <p>Welcome to HTML programming!</p>
</body>
</html>`
            },
            css: {
                name: 'CSS',
                icon: 'üé®',
                version: 'CSS3',
                mode: 'web',
                language: 'css',
                extension: 'css',
                description: 'CSS (Cascading Style Sheets) is used to style and layout web pages.',
                commonUse: 'Styling websites, animations, responsive design, layouts (Flexbox/Grid).',
                sample: `/* CSS Styling Example */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Arial', sans-serif;
}

.container {
    perspective: 1000px;
}

.card {
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    text-align: center;
    transform-style: preserve-3d;
    transition: transform 0.5s;
    animation: float 3s ease-in-out infinite;
}

.card:hover {
    transform: rotateY(10deg) rotateX(5deg);
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
}

h1 {
    background: linear-gradient(135deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-size: 2.5em;
    margin-bottom: 20px;
}

.button {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 30px;
    border-radius: 25px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 20px;
}

.button:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
}`,
                helloWorld: `body {
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
}

h1 {
    color: #333;
    text-align: center;
    margin-top: 50px;
}`
            },
            js: {
                name: 'JavaScript',
                icon: '‚ö°',
                version: 'ES2022',
                mode: 'web',
                language: 'javascript',
                extension: 'js',
                description: 'JavaScript is a programming language that enables interactive web pages.',
                commonUse: 'Web interactivity, frontend frameworks (React, Vue), backend (Node.js), mobile apps.',
                sample: `// Interactive JavaScript Demo
class CodeSphere {
    constructor(name) {
        this.name = name;
        this.users = [];
    }
    
    greet() {
        return \`‚ú® Welcome to \${this.name}!\`;
    }
    
    addUser(user) {
        this.users.push(user);
        return \`üë§ User \${user} added. Total users: \${this.users.length}\`;
    }
    
    getStats() {
        return {
            name: this.name,
            userCount: this.users.length,
            users: this.users
        };
    }
}

// DOM manipulation
document.addEventListener('DOMContentLoaded', () => {
    const app = document.getElementById('app');
    if (!app) {
        const container = document.createElement('div');
        container.id = 'app';
        container.innerHTML = \`
            <div style="text-align: center; padding: 40px;">
                <h1 style="color: #667eea;">\${new CodeSphere('CodeSphere').greet()}</h1>
                <button onclick="demo()" style="
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 25px;
                    cursor: pointer;
                ">Try Me!</button>
                <div id="output" style="margin-top: 20px;"></div>
            </div>
        \`;
        document.body.appendChild(container);
    }
});

function demo() {
    const output = document.getElementById('output');
    const sphere = new CodeSphere('CodeSphere');
    
    let html = '<div style="background: #f0f0f0; padding: 20px; border-radius: 10px;">';
    html += '<h3>üìä JavaScript Demo Output:</h3>';
    html += '<p>' + sphere.greet() + '</p>';
    html += '<p>' + sphere.addUser('Alice') + '</p>';
    html += '<p>' + sphere.addUser('Bob') + '</p>';
    html += '<p>üìà Stats: ' + JSON.stringify(sphere.getStats(), null, 2) + '</p>';
    html += '</div>';
    
    output.innerHTML = html;
}`,
                helloWorld: `console.log("Hello, World!");

// DOM manipulation
document.body.innerHTML = "<h1>Hello, World!</h1><p>Welcome to JavaScript!</p>";`
            },
            // Programming Languages with Piston API support
            python: {
                name: 'Python',
                icon: 'üêç',
                version: '3.10.0',
                mode: 'lang',
                language: 'python',
                extension: 'py',
                description: 'Python is a high-level, interpreted programming language known for its simplicity and readability.',
                commonUse: 'Data Science, Machine Learning, Web Development (Django/Flask), Automation, Scripting.',
                sample: `# Python Program - Data Analysis Example
import statistics
from collections import Counter

class DataAnalyzer:
    """A class for analyzing numerical data"""
    
    def __init__(self, name):
        self.name = name
        self.data = []
    
    def add_data_point(self, value):
        """Add a data point to the analysis"""
        self.data.append(value)
        print(f"  ‚úì Added: {value}")
    
    def analyze(self):
        """Perform statistical analysis on the data"""
        if not self.data:
            return "No data to analyze"
        
        return {
            'count': len(self.data),
            'sum': sum(self.data),
            'mean': statistics.mean(self.data),
            'median': statistics.median(self.data),
            'mode': statistics.mode(self.data) if len(self.data) > 1 else self.data[0],
            'stdev': statistics.stdev(self.data) if len(self.data) > 1 else 0,
            'min': min(self.data),
            'max': max(self.data),
            'range': max(self.data) - min(self.data)
        }
    
    def frequency_distribution(self):
        """Get frequency distribution of data"""
        return Counter(self.data)

def main():
    print("=== Python Data Analysis ===\\n")
    
    # Get user input
    name = input("Enter your name: ")
    print(f"Hello, {name}! Let's analyze some data.\\n")
    
    # Create analyzer
    analyzer = DataAnalyzer(name)
    
    # Sample data
    sample_data = [23, 45, 67, 89, 12, 45, 67, 89, 45, 34, 
                   56, 78, 90, 23, 45, 67, 89, 12, 34, 56]
    
    print("Adding sample data points:")
    for value in sample_data:
        analyzer.add_data_point(value)
    
    # Perform analysis
    print("\\nüìä Statistical Analysis:")
    results = analyzer.analyze()
    for key, value in results.items():
        print(f"  {key}: {value}")
    
    # Frequency distribution
    print("\\nüìà Frequency Distribution:")
    freq = analyzer.frequency_distribution()
    for value, count in sorted(freq.items()):
        print(f"  {value}: {'‚òÖ' * count} ({count})")
    
    print("\\n‚úÖ Analysis complete!")

if __name__ == "__main__":
    main()`,
                helloWorld: `# Hello World Program
print("Hello, World!")

# Simple input example
name = input("What's your name? ")
print(f"Hello, {name}! Welcome to Python!")`
            },
            java: {
                name: 'Java',
                icon: '‚òï',
                version: '15.0.2',
                mode: 'lang',
                language: 'java',
                extension: 'java',
                description: 'Java is a class-based, object-oriented programming language designed for portability.',
                commonUse: 'Enterprise applications, Android development, Web applications, Big Data (Hadoop).',
                sample: `// Java Program - Student Management System
import java.util.*;

class Student {
    private String name;
    private int age;
    private List<Integer> grades;
    private String studentId;
    
    public Student(String name, int age, String studentId) {
        this.name = name;
        this.age = age;
        this.studentId = studentId;
        this.grades = new ArrayList<>();
    }
    
    public void addGrade(int grade) {
        if (grade >= 0 && grade <= 100) {
            grades.add(grade);
            System.out.println("  ‚úì Added grade: " + grade);
        } else {
            System.out.println("  ‚úó Invalid grade: " + grade);
        }
    }
    
    public double calculateGPA() {
        if (grades.isEmpty()) return 0.0;
        return grades.stream().mapToInt(Integer::intValue).average().orElse(0.0);
    }
    
    public String getLetterGrade(double gpa) {
        if (gpa >= 90) return "A";
        else if (gpa >= 80) return "B";
        else if (gpa >= 70) return "C";
        else if (gpa >= 60) return "D";
        else return "F";
    }
    
    public void displayInfo() {
        System.out.println("\\nüìã Student Information:");
        System.out.println("  ID: " + studentId);
        System.out.println("  Name: " + name);
        System.out.println("  Age: " + age);
        System.out.println("  Grades: " + grades);
        double gpa = calculateGPA();
        System.out.printf("  GPA: %.2f (%s)%n", gpa, getLetterGrade(gpa));
        System.out.println("  Status: " + (gpa >= 60 ? "‚úÖ Promoted" : "‚ùå Needs Improvement"));
    }
}

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println("=== Student Management System ===\\n");
        
        // Get student information
        System.out.print("Enter student name: ");
        String name = scanner.nextLine();
        
        System.out.print("Enter student age: ");
        int age = scanner.nextInt();
        scanner.nextLine(); // consume newline
        
        System.out.print("Enter student ID: ");
        String studentId = scanner.nextLine();
        
        // Create student
        Student student = new Student(name, age, studentId);
        
        // Add grades
        System.out.println("\\nEnter grades (enter -1 to stop):");
        while (true) {
            System.out.print("Grade: ");
            int grade = scanner.nextInt();
            if (grade == -1) break;
            student.addGrade(grade);
        }
        
        // Display information
        student.displayInfo();
        
        scanner.close();
    }
}`,
                helloWorld: `public class Main {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
    }
}`
            },
            cpp: {
                name: 'C++',
                icon: '‚ö°',
                version: '14',
                mode: 'lang',
                language: 'cpp',
                extension: 'cpp',
                description: 'C++ is a powerful general-purpose programming language with object-oriented features.',
                commonUse: 'Game development, System programming, Embedded systems, High-performance applications.',
                sample: `// C++ Program - Bank Account Management
#include <iostream>
#include <vector>
#include <string>
#include <iomanip>
#include <memory>

using namespace std;

class BankAccount {
private:
    string accountNumber;
    string accountHolder;
    double balance;
    vector<string> transactionHistory;
    
public:
    BankAccount(string accNum, string holder, double initialBalance = 0) 
        : accountNumber(accNum), accountHolder(holder), balance(initialBalance) {
        addTransaction("Account created with balance: $" + to_string(initialBalance));
    }
    
    void deposit(double amount) {
        if (amount > 0) {
            balance += amount;
            addTransaction("Deposit: $" + to_string(amount));
            cout << "  ‚úì Deposited $" << fixed << setprecision(2) << amount << endl;
        }
    }
    
    bool withdraw(double amount) {
        if (amount > 0 && amount <= balance) {
            balance -= amount;
            addTransaction("Withdrawal: $" + to_string(amount));
            cout << "  ‚úì Withdrawn $" << fixed << setprecision(2) << amount << endl;
            return true;
        } else {
            cout << "  ‚úó Insufficient funds or invalid amount!" << endl;
            return false;
        }
    }
    
    void displayBalance() const {
        cout << "  Current Balance: $" << fixed << setprecision(2) << balance << endl;
    }
    
    void displayInfo() const {
        cout << "\\nüìã Account Information:" << endl;
        cout << "  Account Number: " << accountNumber << endl;
        cout << "  Account Holder: " << accountHolder << endl;
        displayBalance();
    }
    
    void showTransactionHistory() const {
        cout << "\\nüìä Transaction History:" << endl;
        if (transactionHistory.empty()) {
            cout << "  No transactions yet." << endl;
        } else {
            for (const auto& transaction : transactionHistory) {
                cout << "  ‚Ä¢ " << transaction << endl;
            }
        }
    }
    
private:
    void addTransaction(const string& transaction) {
        transactionHistory.push_back(transaction);
    }
};

int main() {
    cout << "=== Bank Account Management System ===\\n" << endl;
    
    string name;
    cout << "Enter account holder name: ";
    getline(cin, name);
    
    // Generate simple account number
    string accNum = "ACC" + to_string(time(nullptr) % 10000);
    
    // Create account
    auto account = make_unique<BankAccount>(accNum, name, 1000.00);
    
    // Display account info
    account->displayInfo();
    
    // Perform transactions
    cout << "\\nüí≥ Performing transactions:" << endl;
    account->deposit(500.00);
    account->withdraw(200.00);
    account->withdraw(1500.00); // This should fail
    
    // Show final balance and history
    cout << "\\nüí∞ Final ";
    account->displayBalance();
    account->showTransactionHistory();
    
    cout << "\\n‚úÖ Banking session completed!" << endl;
    
    return 0;
}`,
                helloWorld: `#include <iostream>
using namespace std;

int main() {
    cout << "Hello, World!" << endl;
    return 0;
}`
            },
            c: {
                name: 'C',
                icon: 'üîß',
                version: '11',
                mode: 'lang',
                language: 'c',
                extension: 'c',
                description: 'C is a general-purpose, procedural programming language.',
                commonUse: 'Operating systems, Embedded systems, System software, Compilers, Hardware drivers.',
                sample: `// C Program - Student Grade Calculator
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_STUDENTS 50
#define MAX_NAME_LENGTH 50

typedef struct {
    char name[MAX_NAME_LENGTH];
    int age;
    float grades[5];
    float average;
    char grade;
} Student;

void calculateAverage(Student* student) {
    float sum = 0;
    for (int i = 0; i < 5; i++) {
        sum += student->grades[i];
    }
    student->average = sum / 5;
    
    // Determine letter grade
    if (student->average >= 90) student->grade = 'A';
    else if (student->average >= 80) student->grade = 'B';
    else if (student->average >= 70) student->grade = 'C';
    else if (student->average >= 60) student->grade = 'D';
    else student->grade = 'F';
}

void printStudent(const Student* student) {
    printf("\nüìã Student Information:\n");
    printf("  Name: %s\n", student->name);
    printf("  Age: %d\n", student->age);
    printf("  Grades: ");
    for (int i = 0; i < 5; i++) {
        printf("%.1f ", student->grades[i]);
    }
    printf("\n  Average: %.2f\n", student->average);
    printf("  Grade: %c\n", student->grade);
}

float calculateClassAverage(Student students[], int count) {
    if (count == 0) return 0;
    
    float sum = 0;
    for (int i = 0; i < count; i++) {
        sum += students[i].average;
    }
    return sum / count;
}

int main() {
    printf("=== Student Grade Calculator ===\n\n");
    
    int numStudents;
    printf("Enter number of students (max %d): ", MAX_STUDENTS);
    scanf("%d", &numStudents);
    getchar(); // consume newline
    
    if (numStudents > MAX_STUDENTS) {
        printf("Too many students! Maximum is %d\n", MAX_STUDENTS);
        return 1;
    }
    
    Student* students = (Student*)malloc(numStudents * sizeof(Student));
    if (students == NULL) {
        printf("Memory allocation failed!\n");
        return 1;
    }
    
    // Input student data
    for (int i = 0; i < numStudents; i++) {
        printf("\nüìù Student %d:\n", i + 1);
        
        printf("  Name: ");
        fgets(students[i].name, MAX_NAME_LENGTH, stdin);
        students[i].name[strcspn(students[i].name, "\n")] = 0;
        
        printf("  Age: ");
        scanf("%d", &students[i].age);
        
        printf("  Enter 5 grades:\n");
        for (int j = 0; j < 5; j++) {
            printf("    Grade %d: ", j + 1);
            scanf("%f", &students[i].grades[j]);
        }
        getchar(); // consume newline
        
        calculateAverage(&students[i]);
    }
    
    // Display all students
    printf("\nüìä Student Records:\n");
    for (int i = 0; i < numStudents; i++) {
        printStudent(&students[i]);
    }
    
    // Class statistics
    float classAverage = calculateClassAverage(students, numStudents);
    printf("\nüè´ Class Statistics:\n");
    printf("  Total Students: %d\n", numStudents);
    printf("  Class Average: %.2f\n", classAverage);
    
    // Find top student
    int topIndex = 0;
    for (int i = 1; i < numStudents; i++) {
        if (students[i].average > students[topIndex].average) {
            topIndex = i;
        }
    }
    printf("  Top Student: %s (%.2f)\n", students[topIndex].name, students[topIndex].average);
    
    free(students);
    printf("\n‚úÖ Program completed!\n");
    
    return 0;
}`,
                helloWorld: `#include <stdio.h>

int main() {
    printf("Hello, World!\\n");
    return 0;
}`
            },
            php: {
                name: 'PHP',
                icon: 'üêò',
                version: '8.2.3',
                mode: 'lang',
                language: 'php',
                extension: 'php',
                description: 'PHP is a server-side scripting language designed for web development.',
                commonUse: 'Web development, Content Management Systems (WordPress), E-commerce, APIs.',
                sample: `<?php
// PHP Program - Task Management System
class Task {
    private $id;
    private $title;
    private $description;
    private $priority;
    private $completed;
    private $createdAt;
    
    public function __construct($title, $description = '', $priority = 'medium') {
        $this->id = uniqid();
        $this->title = $title;
        $this->description = $description;
        $this->priority = $priority;
        $this->completed = false;
        $this->createdAt = date('Y-m-d H:i:s');
    }
    
    public function complete() {
        $this->completed = true;
        echo "  ‚úì Task '{$this->title}' marked as completed\\n";
    }
    
    public function getInfo() {
        return [
            'id' => $this->id,
            'title' => $this->title,
            'priority' => $this->priority,
            'completed' => $this->completed ? '‚úÖ' : '‚≠ï',
            'created' => $this->createdAt
        ];
    }
}

class TaskManager {
    private $tasks = [];
    private $userName;
    
    public function __construct($userName) {
        $this->userName = $userName;
        echo "‚úì Task Manager initialized for $userName\\n";
    }
    
    public function addTask($title, $description = '', $priority = 'medium') {
        $task = new Task($title, $description, $priority);
        $this->tasks[] = $task;
        echo "  ‚úì Added task: $title (Priority: $priority)\\n";
        return $task;
    }
    
    public function findTask($title) {
        foreach ($this->tasks as $task) {
            $info = $task->getInfo();
            if ($info['title'] === $title) {
                return $task;
            }
        }
        return null;
    }
    
    public function completeTask($title) {
        $task = $this->findTask($title);
        if ($task) {
            $task->complete();
            return true;
        }
        echo "  ‚úó Task not found: $title\\n";
        return false;
    }
    
    public function listTasks() {
        echo "\\nüìã Tasks for " . $this->userName . ":\\n";
        if (empty($this->tasks)) {
            echo "  No tasks found.\\n";
            return;
        }
        
        foreach ($this->tasks as $index => $task) {
            $info = $task->getInfo();
            echo "  {$info['completed']} [$index] {$info['title']}";
            echo " (Priority: {$info['priority']})\\n";
        }
    }
    
    public function getStatistics() {
        $total = count($this->tasks);
        $completed = 0;
        $priorityCount = ['high' => 0, 'medium' => 0, 'low' => 0];
        
        foreach ($this->tasks as $task) {
            $info = $task->getInfo();
            if ($info['completed'] === '‚úÖ') {
                $completed++;
            }
            $priorityCount[$info['priority']]++;
        }
        
        return [
            'total' => $total,
            'completed' => $completed,
            'pending' => $total - $completed,
            'completion_rate' => $total > 0 ? round(($completed / $total) * 100, 2) : 0,
            'by_priority' => $priorityCount
        ];
    }
}

// Main program
echo "=== Task Manager ===\\n\\n";

echo "Enter your name: ";
$name = trim(fgets(STDIN));
echo "Hello, $name!\\n\\n";

// Create task manager
$manager = new TaskManager($name);

// Add tasks
$manager->addTask("Complete project report", "Write final report", "high");
$manager->addTask("Review pull requests", "Check code changes", "high");
$manager->addTask("Update documentation", "Add API docs", "medium");
$manager->addTask("Team meeting", "Weekly sync", "low");
$manager->addTask("Fix bug #1234", "Critical bug fix", "high");

// List tasks
$manager->listTasks();

// Complete some tasks
echo "\\nüìù Updating tasks:\\n";
$manager->completeTask("Complete project report");
$manager->completeTask("Fix bug #1234");

// Show updated tasks
$manager->listTasks();

// Show statistics
$stats = $manager->getStatistics();
echo "\\nüìä Statistics:\\n";
echo "  Total tasks: " . $stats['total'] . "\\n";
echo "  Completed: " . $stats['completed'] . "\\n";
echo "  Pending: " . $stats['pending'] . "\\n";
echo "  Completion rate: " . $stats['completion_rate'] . "%\\n";
echo "  By priority:\\n";
foreach ($stats['by_priority'] as $priority => $count) {
    echo "    ‚Ä¢ $priority: $count\\n";
}

echo "\\n‚úÖ Task management session completed!\\n";
?>`,
                helloWorld: `<?php
echo "Hello, World!\\n";

$name = readline("What's your name? ");
echo "Hello, $name! Welcome to PHP!\\n";
?>`
            },
            ruby: {
                name: 'Ruby',
                icon: 'üíé',
                version: '3.0.1',
                mode: 'lang',
                language: 'ruby',
                extension: 'rb',
                description: 'Ruby is a dynamic, object-oriented programming language known for its simplicity.',
                commonUse: 'Web development (Ruby on Rails), Automation, Scripting, Prototyping.',
                sample: `# Ruby Program - Weather Data Analyzer
module Formattable
  def format_as_table(data, title)
    puts "\\n" + "=" * 50
    puts title.center(50)
    puts "=" * 50
    data.each { |key, value| puts "| \#{key.ljust(20)}: \#{value.to_s.rjust(25)} |" }
    puts "-" * 50
  end
end

class WeatherData
  include Formattable
  
  attr_reader :location, :readings
  
  def initialize(location)
    @location = location
    @readings = []
    puts "‚úì Weather station initialized for #{location}"
  end
  
  def add_reading(temperature, humidity, pressure)
    reading = {
      timestamp: Time.now,
      temperature: temperature,
      humidity: humidity,
      pressure: pressure
    }
    @readings << reading
    puts "  ‚úì Added reading: #{temperature}¬∞C, #{humidity}%, #{pressure}hPa"
  end
  
  def analyze
    return nil if @readings.empty?
    
    temps = @readings.map { |r| r[:temperature] }
    humidities = @readings.map { |r| r[:humidity] }
    pressures = @readings.map { |r| r[:pressure] }
    
    {
      location: @location,
      period: "#{@readings.first[:timestamp].strftime('%H:%M')} - #{@readings.last[:timestamp].strftime('%H:%M')}",
      readings_count: @readings.size,
      temperature: {
        current: temps.last,
        average: (temps.sum / temps.size).round(2),
        min: temps.min,
        max: temps.max,
        range: (temps.max - temps.min).round(2)
      },
      humidity: {
        current: humidities.last,
        average: (humidities.sum / humidities.size).round(2),
        min: humidities.min,
        max: humidities.max
      },
      pressure: {
        current: pressures.last,
        average: (pressures.sum / pressures.size).round(2),
        min: pressures.min,
        max: pressures.max
      }
    }
  end
  
  def weather_condition(temp, humidity)
    if temp > 25
      humidity > 70 ? "‚òÅÔ∏è Humid and warm" : "‚òÄÔ∏è Sunny"
    elsif temp > 15
      humidity > 80 ? "üåßÔ∏è Rainy" : "‚õÖ Partly cloudy"
    else
      temp < 5 ? "‚ùÑÔ∏è Cold" : "üå•Ô∏è Cool"
    end
  end
  
  def generate_report
    analysis = analyze
    return puts "No data available" unless analysis
    
    puts "\\nüìä Weather Analysis for #{@location}"
    puts "-" * 40
    
    puts "\\nüå°Ô∏è Temperature:"
    puts "  Current: #{analysis[:temperature][:current]}¬∞C"
    puts "  Average: #{analysis[:temperature][:average]}¬∞C"
    puts "  Range: #{analysis[:temperature][:min]}¬∞C - #{analysis[:temperature][:max]}¬∞C"
    
    puts "\\nüíß Humidity:"
    puts "  Current: #{analysis[:humidity][:current]}%"
    puts "  Average: #{analysis[:humidity][:average]}%"
    
    puts "\\nüåÄ Pressure:"
    puts "  Current: #{analysis[:pressure][:current]}hPa"
    
    puts "\\nüå§Ô∏è Condition: #{weather_condition(analysis[:temperature][:current], analysis[:humidity][:current])}"
    
    # Format as table
    format_as_table({
      "Location" => analysis[:location],
      "Period" => analysis[:period],
      "Avg Temperature" => "#{analysis[:temperature][:average]}¬∞C",
      "Avg Humidity" => "#{analysis[:humidity][:average]}%",
      "Condition" => weather_condition(analysis[:temperature][:current], analysis[:humidity][:current])
    }, "WEATHER SUMMARY")
  end
end

# Main program
puts "=== Weather Data Analyzer ===\\n\\n"

print "Enter location: "
location = gets.chomp
puts "Hello! Analyzing weather for #{location}\\n\\n"

# Create weather station
station = WeatherData.new(location)

# Add sample readings
puts "\\nüìù Adding weather readings:"
station.add_reading(23.5, 65, 1013)
sleep(1)
station.add_reading(24.2, 68, 1012)
sleep(1)
station.add_reading(25.1, 72, 1011)
sleep(1)
station.add_reading(24.8, 70, 1012)
sleep(1)
station.add_reading(23.9, 66, 1014)

# Generate report
station.generate_report

puts "\\n‚úÖ Analysis complete!"`,
                helloWorld: `# Hello World Program
puts "Hello, World!"

print "What's your name? "
name = gets.chomp
puts "Hello, #{name}! Welcome to Ruby!"`
            },
            go: {
                name: 'Go',
                icon: 'üîµ',
                version: '1.16.4',
                mode: 'lang',
                language: 'go',
                extension: 'go',
                description: 'Go is a statically typed, compiled programming language designed at Google.',
                commonUse: 'Cloud services, Microservices, DevOps tools, Web servers, Distributed systems.',
                sample: `// Go Program - Concurrent Web Scraper
package main

import (
    "fmt"
    "sync"
    "time"
    "strings"
)

// Website represents a site to scrape
type Website struct {
    URL      string
    Status   string
    Latency  time.Duration
    Error    error
}

// Scraper manages concurrent scraping
type Scraper struct {
    websites []Website
    results  chan Website
    wg       sync.WaitGroup
}

func NewScraper(urls []string) *Scraper {
    websites := make([]Website, len(urls))
    for i, url := range urls {
        websites[i] = Website{URL: url}
    }
    
    return &Scraper{
        websites: websites,
        results:  make(chan Website, len(urls)),
    }
}

func (s *Scraper) scrapeWebsite(website Website) {
    defer s.wg.Done()
    
    // Simulate scraping
    start := time.Now()
    
    // Simulate different response times based on URL
    var latency time.Duration
    var status string
    var err error
    
    switch {
    case strings.Contains(website.URL, "google"):
        latency = 150 * time.Millisecond
        status = "200 OK"
    case strings.Contains(website.URL, "github"):
        latency = 300 * time.Millisecond
        status = "200 OK"
    case strings.Contains(website.URL, "stackoverflow"):
        latency = 250 * time.Millisecond
        status = "200 OK"
    case strings.Contains(website.URL, "example"):
        latency = 100 * time.Millisecond
        status = "200 OK"
    default:
        latency = 500 * time.Millisecond
        status = "404 Not Found"
        if strings.Contains(website.URL, "error") {
            err = fmt.Errorf("connection timeout")
        }
    }
    
    time.Sleep(latency)
    
    result := Website{
        URL:     website.URL,
        Status:  status,
        Latency: time.Since(start),
        Error:   err,
    }
    
    s.results <- result
}

func (s *Scraper) Run(concurrency int) {
    // Create semaphore channel for concurrency control
    semaphore := make(chan struct{}, concurrency)
    
    for _, website := range s.websites {
        s.wg.Add(1)
        semaphore <- struct{}{} // Acquire semaphore
        
        go func(w Website) {
            defer func() { <-semaphore }() // Release semaphore
            s.scrapeWebsite(w)
        }(website)
    }
    
    // Close results channel when all scraping is done
    go func() {
        s.wg.Wait()
        close(s.results)
    }()
}

func (s *Scraper) CollectResults() []Website {
    var results []Website
    for result := range s.results {
        results = append(results, result)
    }
    return results
}

func main() {
    fmt.Println("=== Concurrent Web Scraper ===\n")
    
    var name string
    fmt.Print("Enter your name: ")
    fmt.Scanln(&name)
    fmt.Printf("Hello, %s! Starting web scraper...\n\n", name)
    
    // List of websites to scrape
    urls := []string{
        "https://google.com",
        "https://github.com",
        "https://stackoverflow.com",
        "https://example.com",
        "https://error-site.com",
        "https://unknown-site.com",
    }
    
    fmt.Printf("üìã URLs to scrape (%d sites):\n", len(urls))
    for i, url := range urls {
        fmt.Printf("  %d. %s\n", i+1, url)
    }
    
    // Create and run scraper
    scraper := NewScraper(urls)
    
    fmt.Printf("\nüöÄ Starting scrape with 3 concurrent workers...\n\n")
    startTime := time.Now()
    
    scraper.Run(3)
    results := scraper.CollectResults()
    
    totalTime := time.Since(startTime)
    
    // Display results
    fmt.Println("üìä Scraping Results:")
    fmt.Println(strings.Repeat("-", 80))
    fmt.Printf("%-30s %-15s %-15s %s\n", "URL", "Status", "Latency", "Error")
    fmt.Println(strings.Repeat("-", 80))
    
    var successCount, errorCount int
    var totalLatency time.Duration
    
    for _, r := range results {
        status := r.Status
        if r.Error != nil {
            status = "ERROR"
            errorCount++
        } else {
            successCount++
        }
        
        latency := r.Latency.Round(time.Millisecond)
        totalLatency += r.Latency
        
        errorMsg := ""
        if r.Error != nil {
            errorMsg = r.Error.Error()
        }
        
        fmt.Printf("%-30s %-15s %-15v %s\n", 
            r.URL, status, latency, errorMsg)
    }
    
    fmt.Println(strings.Repeat("-", 80))
    
    // Statistics
    avgLatency := time.Duration(int64(totalLatency) / int64(len(results)))
    
    fmt.Printf("\nüìà Statistics:\n")
    fmt.Printf("  Total time: %v\n", totalTime.Round(time.Millisecond))
    fmt.Printf("  Successful: %d\n", successCount)
    fmt.Printf("  Failed: %d\n", errorCount)
    fmt.Printf("  Average latency: %v\n", avgLatency.Round(time.Millisecond))
    fmt.Printf("  Success rate: %.1f%%\n", float64(successCount)/float64(len(results))*100)
    
    fmt.Printf("\n‚úÖ Scraping completed!\n")
}`,
                helloWorld: `package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}`
            },
            rust: {
                name: 'Rust',
                icon: 'ü¶Ä',
                version: '1.68.2',
                mode: 'lang',
                language: 'rust',
                extension: 'rs',
                description: 'Rust is a systems programming language focused on safety and performance.',
                commonUse: 'System programming, WebAssembly, Game engines, Operating systems, Blockchain.',
                sample: `// Rust Program - File System Simulator
use std::collections::HashMap;
use std::fmt;

#[derive(Debug, Clone)]
enum FileType {
    Text,
    Binary,
    Directory,
}

#[derive(Debug, Clone)]
struct File {
    name: String,
    file_type: FileType,
    size: u64,
    content: String,
    permissions: u16,
}

impl File {
    fn new(name: &str, file_type: FileType) -> Self {
        File {
            name: String::from(name),
            file_type,
            size: 0,
            content: String::new(),
            permissions: 0o644,
        }
    }
    
    fn write(&mut self, content: &str) {
        self.content.push_str(content);
        self.size = self.content.len() as u64;
    }
    
    fn read(&self) -> &str {
        &self.content
    }
}

impl fmt::Display for File {
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
        let type_str = match self.file_type {
            FileType::Text => "üìÑ",
            FileType::Binary => "‚öôÔ∏è",
            FileType::Directory => "üìÅ",
        };
        write!(f, "{} {} ({} bytes)", type_str, self.name, self.size)
    }
}

struct FileSystem {
    files: HashMap<String, File>,
    current_directory: String,
}

impl FileSystem {
    fn new() -> Self {
        let mut fs = FileSystem {
            files: HashMap::new(),
            current_directory: String::from("/"),
        };
        
        // Create some default files
        fs.create_file("readme.txt", FileType::Text);
        fs.create_file("config.json", FileType::Text);
        fs.create_file("program.exe", FileType::Binary);
        
        fs
    }
    
    fn create_file(&mut self, name: &str, file_type: FileType) {
        let path = self.get_full_path(name);
        let file = File::new(name, file_type);
        self.files.insert(path, file);
        println!("  ‚úì Created file: {}", name);
    }
    
    fn get_full_path(&self, name: &str) -> String {
        if self.current_directory == "/" {
            format!("/{}", name)
        } else {
            format!("{}/{}", self.current_directory, name)
        }
    }
    
    fn write_file(&mut self, name: &str, content: &str) -> Result<(), String> {
        let path = self.get_full_path(name);
        
        if let Some(file) = self.files.get_mut(&path) {
            match file.file_type {
                FileType::Directory => Err(format!("Cannot write to directory: {}", name)),
                _ => {
                    file.write(content);
                    println!("  ‚úì Wrote {} bytes to: {}", content.len(), name);
                    Ok(())
                }
            }
        } else {
            Err(format!("File not found: {}", name))
        }
    }
    
    fn read_file(&self, name: &str) -> Result<String, String> {
        let path = self.get_full_path(name);
        
        if let Some(file) = self.files.get(&path) {
            match file.file_type {
                FileType::Directory => Err(format!("Cannot read directory: {}", name)),
                _ => Ok(format!("üìÑ Content of {}:\n{}\n", name, file.read())),
            }
        } else {
            Err(format!("File not found: {}", name))
        }
    }
    
    fn list_files(&self) {
        println!("\nüìã Files in {}:", self.current_directory);
        println!("{}", "-".repeat(40));
        
        let mut found = false;
        for (path, file) in &self.files {
            if path.starts_with(&self.current_directory) && path != &self.current_directory {
                let name = path.trim_start_matches(&self.current_directory).trim_start_matches('/');
                if !name.contains('/') {  // Only show files in current directory
                    println!("  {}", file);
                    found = true;
                }
            }
        }
        
        if !found {
            println!("  (empty)");
        }
    }
    
    fn get_stats(&self) -> HashMap<String, u64> {
        let mut stats = HashMap::new();
        let mut total_size = 0;
        let mut file_count = 0;
        let mut dir_count = 0;
        
        for file in self.files.values() {
            match file.file_type {
                FileType::Directory => dir_count += 1,
                _ => {
                    file_count += 1;
                    total_size += file.size;
                }
            }
        }
        
        stats.insert("files".to_string(), file_count);
        stats.insert("directories".to_string(), dir_count);
        stats.insert("total_size".to_string(), total_size);
        stats.insert("avg_size".to_string(), if file_count > 0 { total_size / file_count } else { 0 });
        
        stats
    }
}

fn main() {
    println!("=== Rust File System Simulator ===\n");
    
    let mut input = String::new();
    println!("Enter your name:");
    std::io::stdin().read_line(&mut input).expect("Failed to read line");
    let name = input.trim();
    println!("Hello, {}! Welcome to Rust FS\n", name);
    
    // Create file system
    let mut fs = FileSystem::new();
    
    // List initial files
    fs.list_files();
    
    // Perform operations
    println!("\nüìù Performing file operations:");
    
    // Write to files
    match fs.write_file("readme.txt", "Welcome to CodeSphere!\nThis is a Rust file system simulator.") {
        Ok(_) => (),
        Err(e) => println!("  Error: {}", e),
    }
    
    match fs.write_file("config.json", "{\n  \"name\": \"CodeSphere\",\n  \"version\": \"1.0.0\"\n}") {
        Ok(_) => (),
        Err(e) => println!("  Error: {}", e),
    }
    
    // Read files
    println!("\nüìñ Reading files:");
    match fs.read_file("readme.txt") {
        Ok(content) => print!("{}", content),
        Err(e) => println!("  Error: {}", e),
    }
    
    // Create new file
    fs.create_file("notes.txt", FileType::Text);
    match fs.write_file("notes.txt", "Remember to:\n- Learn Rust\n- Build awesome projects\n- Contribute to open source") {
        Ok(_) => (),
        Err(e) => println!("  Error: {}", e),
    }
    
    // List files again
    fs.list_files();
    
    // Show statistics
    println!("\nüìä File System Statistics:");
    let stats = fs.get_stats();
    for (key, value) in stats {
        match key.as_str() {
            "total_size" => println!("  {}: {} bytes", key, value),
            "avg_size" => println!("  {}: {} bytes", key, value),
            _ => println!("  {}: {}", key, value),
        }
    }
    
    println!("\n‚úÖ Simulation complete!");
}`,
                helloWorld: `fn main() {
    println!("Hello, World!");
}`
            },
            typescript: {
                name: 'TypeScript',
                icon: 'üìò',
                version: '5.0.3',
                mode: 'lang',
                language: 'typescript',
                extension: 'ts',
                description: 'TypeScript is a typed superset of JavaScript that compiles to plain JavaScript.',
                commonUse: 'Large-scale web applications, Enterprise software, Frontend frameworks, Node.js backend.',
                sample: `// TypeScript Program - E-Commerce Shopping Cart
interface Product {
    id: number;
    name: string;
    price: number;
    category: string;
    inStock: boolean;
    quantity?: number;
}

interface CartItem extends Product {
    quantity: number;
    subtotal: number;
}

class ShoppingCart {
    private items: Map<number, CartItem> = new Map();
    private taxRate: number = 0.1; // 10% tax
    private shippingRate: number = 5; // $5 shipping
    
    constructor(public customerName: string) {
        console.log(`üõí Shopping cart created for ${customerName}`);
    }
    
    addItem(product: Product, quantity: number = 1): void {
        if (!product.inStock) {
            console.log(`  ‚úó ${product.name} is out of stock`);
            return;
        }
        
        if (this.items.has(product.id)) {
            const existing = this.items.get(product.id)!;
            existing.quantity += quantity;
            existing.subtotal = existing.price * existing.quantity;
            console.log(`  ‚úì Updated ${product.name} quantity to ${existing.quantity}`);
        } else {
            const cartItem: CartItem = {
                ...product,
                quantity,
                subtotal: product.price * quantity
            };
            this.items.set(product.id, cartItem);
            console.log(`  ‚úì Added ${product.name} (x${quantity}) to cart`);
        }
    }
    
    removeItem(productId: number): void {
        if (this.items.delete(productId)) {
            console.log(`  ‚úì Item removed from cart`);
        } else {
            console.log(`  ‚úó Item not found in cart`);
        }
    }
    
    updateQuantity(productId: number, quantity: number): void {
        const item = this.items.get(productId);
        if (item) {
            if (quantity <= 0) {
                this.removeItem(productId);
            } else {
                item.quantity = quantity;
                item.subtotal = item.price * quantity;
                console.log(`  ‚úì Updated quantity to ${quantity}`);
            }
        } else {
            console.log(`  ‚úó Item not found`);
        }
    }
    
    calculateSubtotal(): number {
        let subtotal = 0;
        for (const item of this.items.values()) {
            subtotal += item.subtotal;
        }
        return subtotal;
    }
    
    calculateTax(): number {
        return this.calculateSubtotal() * this.taxRate;
    }
    
    calculateShipping(): number {
        // Free shipping over $50
        return this.calculateSubtotal() > 50 ? 0 : this.shippingRate;
    }
    
    calculateTotal(): number {
        return this.calculateSubtotal() + this.calculateTax() + this.calculateShipping();
    }
    
    getCartSummary(): Record<string, any> {
        const subtotal = this.calculateSubtotal();
        const tax = this.calculateTax();
        const shipping = this.calculateShipping();
        const total = this.calculateTotal();
        
        return {
            customer: this.customerName,
            itemCount: this.items.size,
            totalItems: Array.from(this.items.values()).reduce((acc, item) => acc + item.quantity, 0),
            subtotal: parseFloat(subtotal.toFixed(2)),
            tax: parseFloat(tax.toFixed(2)),
            shipping: parseFloat(shipping.toFixed(2)),
            total: parseFloat(total.toFixed(2)),
            items: Array.from(this.items.values()).map(item => ({
                name: item.name,
                quantity: item.quantity,
                price: item.price,
                subtotal: item.subtotal
            }))
        };
    }
    
    displayCart(): void {
        const summary = this.getCartSummary();
        
        console.log("\n" + "=".repeat(50));
        console.log(`üõçÔ∏è  Shopping Cart - ${summary.customer}`);
        console.log("=".repeat(50));
        
        if (summary.items.length === 0) {
            console.log("Your cart is empty");
        } else {
            console.log("\nüì¶ Items:");
            summary.items.forEach((item: any, index: number) => {
                console.log(`  ${index + 1}. ${item.name}`);
                console.log(`     ${item.quantity} x $${item.price} = $${item.subtotal}`);
            });
            
            console.log("\n" + "-".repeat(50));
            console.log(`üìä Summary:`);
            console.log(`  Subtotal: $${summary.subtotal}`);
            console.log(`  Tax (10%): $${summary.tax}`);
            console.log(`  Shipping: $${summary.shipping}`);
            console.log(`  Total: $${summary.total}`);
        }
        console.log("=".repeat(50));
    }
}

// Main execution
function main(): void {
    console.log("=== E-Commerce Shopping Cart ===\n");
    
    // Sample products
    const products: Product[] = [
        { id: 1, name: "Laptop", price: 999.99, category: "Electronics", inStock: true },
        { id: 2, name: "Mouse", price: 29.99, category: "Electronics", inStock: true },
        { id: 3, name: "Keyboard", price: 79.99, category: "Electronics", inStock: true },
        { id: 4, name: "Monitor", price: 299.99, category: "Electronics", inStock: false },
        { id: 5, name: "USB Cable", price: 9.99, category: "Accessories", inStock: true }
    ];
    
    console.log("Available Products:");
    products.forEach(p => {
        console.log(`  ${p.id}. ${p.name} - $${p.price} ${p.inStock ? '‚úÖ' : '‚ùå'}`);
    });
    
    // Create cart
    const cart = new ShoppingCart("John Doe");
    
    // Add items
    console.log("\nüõí Adding items to cart:");
    cart.addItem(products[0]); // Laptop
    cart.addItem(products[1], 2); // 2 Mice
    cart.addItem(products[2]); // Keyboard
    cart.addItem(products[3]); // Monitor (out of stock)
    cart.addItem(products[4], 3); // 3 USB Cables
    
    // Update quantities
    console.log("\nüîÑ Updating quantities:");
    cart.updateQuantity(1, 1); // Keep 1 laptop
    cart.updateQuantity(2, 3); // Increase mice to 3
    
    // Display cart
    cart.displayCart();
    
    // Remove item
    console.log("\nüóëÔ∏è Removing item:");
    cart.removeItem(4);
    
    // Final cart
    cart.displayCart();
    
    console.log("\n‚úÖ Shopping session completed!");
}

// Run the program
main();`,
                helloWorld: `console.log("Hello, World!");

const name: string = "TypeScript";
console.log(\`Welcome to \${name}!\`);`
            },
            csharp: {
                name: 'C#',
                icon: '#Ô∏è‚É£',
                version: '10.0',
                mode: 'lang',
                language: 'csharp',
                extension: 'cs',
                description: 'C# is a modern, object-oriented programming language developed by Microsoft.',
                commonUse: 'Windows applications, Game development (Unity), Enterprise software, Web services.',
                sample: `// C# Program - Library Management System
using System;
using System.Collections.Generic;
using System.Linq;

namespace LibraryManagement
{
    public class Book
    {
        public string ISBN { get; set; }
        public string Title { get; set; }
        public string Author { get; set; }
        public int Year { get; set; }
        public bool IsAvailable { get; set; }
        
        public Book(string isbn, string title, string author, int year)
        {
            ISBN = isbn;
            Title = title;
            Author = author;
            Year = year;
            IsAvailable = true;
        }
        
        public override string ToString()
        {
            return $"üìö {Title} by {Author} ({Year}) - {(IsAvailable ? "‚úÖ Available" : "‚ùå Borrowed")}";
        }
    }
    
    public class Member
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Email { get; set; }
        public List<Book> BorrowedBooks { get; set; }
        
        public Member(int id, string name, string email)
        {
            Id = id;
            Name = name;
            Email = email;
            BorrowedBooks = new List<Book>();
        }
        
        public override string ToString()
        {
            return $"üë§ {Name} (ID: {Id}) - Books borrowed: {BorrowedBooks.Count}";
        }
    }
    
    public class Library
    {
        private List<Book> books;
        private List<Member> members;
        private Dictionary<Book, DateTime> dueDates;
        
        public string Name { get; set; }
        
        public Library(string name)
        {
            Name = name;
            books = new List<Book>();
            members = new List<Member>();
            dueDates = new Dictionary<Book, DateTime>();
            Console.WriteLine($"üìö Library '{name}' initialized");
        }
        
        public void AddBook(Book book)
        {
            books.Add(book);
            Console.WriteLine($"  ‚úì Added: {book.Title}");
        }
        
        public void RegisterMember(Member member)
        {
            members.Add(member);
            Console.WriteLine($"  ‚úì Registered: {member.Name}");
        }
        
        public bool BorrowBook(int memberId, string isbn)
        {
            var member = members.FirstOrDefault(m => m.Id == memberId);
            if (member == null)
            {
                Console.WriteLine("  ‚úó Member not found");
                return false;
            }
            
            var book = books.FirstOrDefault(b => b.ISBN == isbn && b.IsAvailable);
            if (book == null)
            {
                Console.WriteLine("  ‚úó Book not available");
                return false;
            }
            
            book.IsAvailable = false;
            member.BorrowedBooks.Add(book);
            dueDates[book] = DateTime.Now.AddDays(14);
            
            Console.WriteLine($"  ‚úì {member.Name} borrowed '{book.Title}'");
            Console.WriteLine($"     Due date: {dueDates[book]:MMM dd, yyyy}");
            return true;
        }
        
        public bool ReturnBook(int memberId, string isbn)
        {
            var member = members.FirstOrDefault(m => m.Id == memberId);
            if (member == null)
            {
                Console.WriteLine("  ‚úó Member not found");
                return false;
            }
            
            var book = member.BorrowedBooks.FirstOrDefault(b => b.ISBN == isbn);
            if (book == null)
            {
                Console.WriteLine("  ‚úó Book not borrowed by this member");
                return false;
            }
            
            book.IsAvailable = true;
            member.BorrowedBooks.Remove(book);
            dueDates.Remove(book);
            
            Console.WriteLine($"  ‚úì {member.Name} returned '{book.Title}'");
            return true;
        }
        
        public void DisplayBooks()
        {
            Console.WriteLine($"\nüìñ Books in {Name}:");
            Console.WriteLine(new string('-', 50));
            
            var available = books.Where(b => b.IsAvailable).ToList();
            var borrowed = books.Where(b => !b.IsAvailable).ToList();
            
            Console.WriteLine($"\n‚úÖ Available ({available.Count}):");
            foreach (var book in available.Take(5))
            {
                Console.WriteLine($"  {book}");
            }
            if (available.Count > 5)
                Console.WriteLine($"  ... and {available.Count - 5} more");
            
            Console.WriteLine($"\n‚ùå Borrowed ({borrowed.Count}):");
            foreach (var book in borrowed.Take(5))
            {
                var dueDate = dueDates.ContainsKey(book) ? dueDates[book] : DateTime.Now;
                var daysLeft = (dueDate - DateTime.Now).Days;
                Console.WriteLine($"  {book.Title} (Due in {daysLeft} days)");
            }
        }
        
        public void DisplayMembers()
        {
            Console.WriteLine($"\nüë• Library Members ({members.Count}):");
            Console.WriteLine(new string('-', 50));
            foreach (var member in members)
            {
                Console.WriteLine($"  {member}");
            }
        }
        
        public void GenerateReport()
        {
            Console.WriteLine("\n" + "=".Repeat(60));
            Console.WriteLine($"üìä LIBRARY REPORT - {Name}");
            Console.WriteLine("=".Repeat(60));
            
            Console.WriteLine($"\nüìä Statistics:");
            Console.WriteLine($"  Total Books: {books.Count}");
            Console.WriteLine($"  Available: {books.Count(b => b.IsAvailable)}");
            Console.WriteLine($"  Borrowed: {books.Count(b => !b.IsAvailable)}");
            Console.WriteLine($"  Total Members: {members.Count}");
            Console.WriteLine($"  Active Borrows: {members.Sum(m => m.BorrowedBooks.Count)}");
            
            Console.WriteLine("\n" + "=".Repeat(60));
        }
    }
    
    public static class StringExtensions
    {
        public static string Repeat(this string s, int count)
        {
            return string.Join("", Enumerable.Repeat(s, count));
        }
    }
    
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("=== Library Management System ===\n");
            
            Console.Write("Enter your name: ");
            string name = Console.ReadLine();
            Console.WriteLine($"Hello, {name}! Welcome to the Library!\n");
            
            // Create library
            var library = new Library("City Central Library");
            
            // Add books
            Console.WriteLine("\nüìö Adding books:");
            library.AddBook(new Book("978-0", "The Great Gatsby", "F. Scott Fitzgerald", 1925));
            library.AddBook(new Book("978-1", "To Kill a Mockingbird", "Harper Lee", 1960));
            library.AddBook(new Book("978-2", "1984", "George Orwell", 1949));
            library.AddBook(new Book("978-3", "Pride and Prejudice", "Jane Austen", 1813));
            library.AddBook(new Book("978-4", "The Catcher in the Rye", "J.D. Salinger", 1951));
            
            // Register members
            Console.WriteLine("\nüìù Registering members:");
            library.RegisterMember(new Member(1, "Alice Johnson", "alice@email.com"));
            library.RegisterMember(new Member(2, "Bob Smith", "bob@email.com"));
            
            // Borrow books
            Console.WriteLine("\nüîÑ Processing borrows:");
            library.BorrowBook(1, "978-0");
            library.BorrowBook(1, "978-2");
            library.BorrowBook(2, "978-1");
            
            // Display books
            library.DisplayBooks();
            
            // Return a book
            Console.WriteLine("\nüîÑ Processing return:");
            library.ReturnBook(1, "978-0");
            
            // Display members
            library.DisplayMembers();
            
            // Generate report
            library.GenerateReport();
            
            Console.WriteLine("\n‚úÖ Library session completed!");
        }
    }
}`,
                helloWorld: `using System;

class Program {
    static void Main() {
        Console.WriteLine("Hello, World!");
    }
}`
            },
            swift: {
                name: 'Swift',
                icon: '‚ö°',
                version: '5.3.3',
                mode: 'lang',
                language: 'swift',
                extension: 'swift',
                description: 'Swift is a powerful and intuitive programming language for iOS, macOS, and beyond.',
                commonUse: 'iOS/macOS app development, Server-side Swift, Cross-platform mobile apps.',
                sample: `// Swift Program - Fitness Tracker
import Foundation

// Protocol for workout tracking
protocol WorkoutTrackable {
    var name: String { get }
    var duration: TimeInterval { get set }
    var caloriesBurned: Double { get }
    func summary() -> String
}

// Workout types
enum WorkoutType: String {
    case running = "üèÉ Running"
    case cycling = "üö¥ Cycling"
    case swimming = "üèä Swimming"
    case weightlifting = "üèãÔ∏è Weightlifting"
    case yoga = "üßò Yoga"
}

// Workout class
class Workout: WorkoutTrackable, CustomStringConvertible {
    let name: String
    let type: WorkoutType
    var duration: TimeInterval
    let date: Date
    private let caloriesPerMinute: Double
    
    var caloriesBurned: Double {
        return duration * caloriesPerMinute / 60.0
    }
    
    init(name: String, type: WorkoutType, duration: TimeInterval) {
        self.name = name
        self.type = type
        self.duration = duration
        self.date = Date()
        
        // Set calories per minute based on workout type
        switch type {
        case .running:
            self.caloriesPerMinute = 600.0 // calories per hour
        case .cycling:
            self.caloriesPerMinute = 500.0
        case .swimming:
            self.caloriesPerMinute = 550.0
        case .weightlifting:
            self.caloriesPerMinute = 400.0
        case .yoga:
            self.caloriesPerMinute = 300.0
        }
    }
    
    func summary() -> String {
        let formatter = DateFormatter()
        formatter.dateStyle = .medium
        formatter.timeStyle = .short
        
        return """
            \(type.rawValue): \(name)
            üìÖ \(formatter.string(from: date))
            ‚è±Ô∏è Duration: \(String(format: "%.1f", duration / 60)) minutes
            üî• Calories: \(String(format: "%.0f", caloriesBurned))
            """
    }
    
    var description: String {
        return "\(type.rawValue): \(name) - \(String(format: "%.0f", duration / 60))min"
    }
}

// Fitness tracker class
class FitnessTracker {
    var userName: String
    var workouts: [Workout]
    var dailyGoal: Double // calories
    
    init(userName: String, dailyGoal: Double = 500.0) {
        self.userName = userName
        self.workouts = []
        self.dailyGoal = dailyGoal
        print("‚úÖ Fitness tracker initialized for \(userName)")
    }
    
    func addWorkout(_ workout: Workout) {
        workouts.append(workout)
        print("  ‚úì Added: \(workout.name) (\(workout.type.rawValue))")
    }
    
    func totalCaloriesBurned() -> Double {
        return workouts.reduce(0) { $0 + $1.caloriesBurned }
    }
    
    func totalWorkoutTime() -> TimeInterval {
        return workouts.reduce(0) { $0 + $1.duration }
    }
    
    func workoutsByType(_ type: WorkoutType) -> [Workout] {
        return workouts.filter { $0.type == type }
    }
    
    func todaysWorkouts() -> [Workout] {
        let calendar = Calendar.current
        let today = Date()
        
        return workouts.filter { workout in
            calendar.isDate(workout.date, inSameDayAs: today)
        }
    }
    
    func weeklyProgress() -> Double {
        let calendar = Calendar.current
        let oneWeekAgo = calendar.date(byAdding: .day, value: -7, to: Date())!
        
        let weeklyCalories = workouts
            .filter { $0.date >= oneWeekAgo }
            .reduce(0) { $0 + $1.caloriesBurned }
        
        let weeklyGoal = dailyGoal * 7
        return (weeklyCalories / weeklyGoal) * 100
    }
    
    func generateReport() {
        print("\n" + "=".repeat(60))
        print("üìä FITNESS REPORT - \(userName)")
        print("=".repeat(60))
        
        let totalCal = totalCaloriesBurned()
        let totalTime = totalWorkoutTime()
        let todayWorkouts = todaysWorkouts()
        
        print("\nüìà Overall Statistics:")
        print("  Total Workouts: \(workouts.count)")
        print("  Total Time: \(String(format: "%.1f", totalTime / 3600)) hours")
        print("  Total Calories: \(String(format: "%.0f", totalCal))")
        
        if workouts.count > 0 {
            print("  Avg Calories/Workout: \(String(format: "%.0f", totalCal / Double(workouts.count)))")
        }
        
        print("\nüìÖ Today's Activity:")
        if todayWorkouts.isEmpty {
            print("  No workouts logged today")
        } else {
            for workout in todayWorkouts {
                print("  ‚Ä¢ \(workout.summary())")
            }
            let todayCal = todayWorkouts.reduce(0) { $0 + $1.caloriesBurned }
            let progress = min((todayCal / dailyGoal) * 100, 100)
            print("  üéØ Daily Goal Progress: \(String(format: "%.1f", progress))%")
        }
        
        print("\nüí™ Workout Breakdown:")
        let running = workoutsByType(.running)
        let cycling = workoutsByType(.cycling)
        let swimming = workoutsByType(.swimming)
        
        if !running.isEmpty {
            print("  üèÉ Running: \(running.count) workouts - \(String(format: "%.0f", running.reduce(0) { $0 + $1.caloriesBurned })) cal")
        }
        if !cycling.isEmpty {
            print("  üö¥ Cycling: \(cycling.count) workouts - \(String(format: "%.0f", cycling.reduce(0) { $0 + $1.caloriesBurned })) cal")
        }
        if !swimming.isEmpty {
            print("  üèä Swimming: \(swimming.count) workouts - \(String(format: "%.0f", swimming.reduce(0) { $0 + $1.caloriesBurned })) cal")
        }
        
        let weeklyProgress = weeklyProgress()
        print("\nüìä Weekly Progress: \(String(format: "%.1f", weeklyProgress))%")
        
        let progressBar = String(repeating: "‚ñà", count: Int(weeklyProgress / 10)) +
                         String(repeating: "‚ñë", count: 10 - Int(weeklyProgress / 10))
        print("  [\(progressBar)]")
        
        print("\n" + "=".repeat(60))
    }
    
    func listWorkouts() {
        print("\nüìã Workout History:")
        print("-".repeat(50))
        
        let sortedWorkouts = workouts.sorted { $0.date > $1.date }
        for (index, workout) in sortedWorkouts.prefix(10).enumerated() {
            print("\(index + 1). \(workout)")
        }
        
        if workouts.count > 10 {
            print("   ... and \(workouts.count - 10) more")
        }
    }
}

// String extension for repeating
extension String {
    static func `repeat`(_ count: Int) -> String {
        return String(repeating: self, count: count)
    }
    
    func `repeat`(_ count: Int) -> String {
        return String(repeating: self, count: count)
    }
}

// Main program
print("=== Fitness Tracker ===\n")

print("Enter your name: ", terminator: "")
let name = readLine() ?? "User"
print("Hello, \(name)! Ready to get fit?\n")

// Create tracker
let tracker = FitnessTracker(userName: name, dailyGoal: 500)

// Add workouts
print("\nüí™ Logging workouts:")
tracker.addWorkout(Workout(name: "Morning Run", type: .running, duration: 30 * 60))
tracker.addWorkout(Workout(name: "Evening Swim", type: .swimming, duration: 45 * 60))
tracker.addWorkout(Workout(name: "Weight Training", type: .weightlifting, duration: 60 * 60))
tracker.addWorkout(Workout(name: "Yoga Session", type: .yoga, duration: 40 * 60))

// List workouts
tracker.listWorkouts()

// Generate report
tracker.generateReport()

print("\n‚úÖ Fitness tracking complete! Keep up the good work!")`,
                helloWorld: `print("Hello, World!")

let name = "Swift"
print("Welcome to \(name)!")`
            },
            r: {
                name: 'R',
                icon: 'üìä',
                version: '4.1.2',
                mode: 'lang',
                language: 'r',
                extension: 'r',
                description: 'R is a programming language for statistical computing and graphics.',
                commonUse: 'Statistical analysis, Data visualization, Machine learning, Research, Data science.',
                sample: `# R Program - Statistical Data Analysis
# Load required libraries (simulated)

# Create a data analysis class using S3 style
create_analyzer <- function(name) {
  analyzer <- list(
    name = name,
    data = numeric(0),
    results = list()
  )
  class(analyzer) <- "DataAnalyzer"
  return(analyzer)
}

# Add data method
add_data <- function(analyzer, values) {
  analyzer$data <- c(analyzer$data, values)
  cat("  ‚úì Added", length(values), "data points\n")
  return(analyzer)
}

# Summary method
summary.DataAnalyzer <- function(object, ...) {
  data <- object$data
  if (length(data) == 0) {
    return("No data available")
  }
  
  list(
    count = length(data),
    mean = mean(data),
    median = median(data),
    sd = sd(data),
    var = var(data),
    min = min(data),
    max = max(data),
    range = diff(range(data)),
    q1 = quantile(data, 0.25),
    q3 = quantile(data, 0.75),
    iqr = IQR(data)
  )
}

# Plot function (simulated)
plot.DataAnalyzer <- function(x, ...) {
  data <- x$data
  if (length(data) == 0) {
    cat("No data to plot\n")
    return()
  }
  
  cat("\nüìä Data Distribution:\n")
  cat("====================\n")
  
  # Create a simple histogram in text
  hist_data <- hist(data, plot = FALSE)
  max_count <- max(hist_data$counts)
  
  for (i in seq_along(hist_data$breaks[-1])) {
    bar_length <- round(hist_data$counts[i] / max_count * 30)
    bar <- paste(rep("‚ñà", bar_length), collapse = "")
    cat(sprintf("[%4.1f - %4.1f] %s %d\n", 
                hist_data$breaks[i], 
                hist_data$breaks[i+1],
                bar,
                hist_data$counts[i]))
  }
}

# Analyze function
analyze <- function(analyzer) {
  cat("\nüìà Statistical Analysis for", analyzer$name, "\n")
  cat("====================================\n")
  
  stats <- summary(analyzer)
  
  cat("\nüìä Descriptive Statistics:\n")
  cat(sprintf("  Count: %d\n", stats$count))
  cat(sprintf("  Mean: %.2f\n", stats$mean))
  cat(sprintf("  Median: %.2f\n", stats$median))
  cat(sprintf("  Standard Deviation: %.2f\n", stats$sd))
  cat(sprintf("  Variance: %.2f\n", stats$var))
  
  cat("\nüìè Range Statistics:\n")
  cat(sprintf("  Min: %.2f\n", stats$min))
  cat(sprintf("  Max: %.2f\n", stats$max))
  cat(sprintf("  Range: %.2f\n", stats$range))
  
  cat("\nüìê Quartiles:\n")
  cat(sprintf("  Q1 (25%%): %.2f\n", stats$q1))
  cat(sprintf("  Q3 (75%%): %.2f\n", stats$q3))
  cat(sprintf("  IQR: %.2f\n", stats$iqr))
  
  # Check for outliers
  lower_bound <- stats$q1 - 1.5 * stats$iqr
  upper_bound <- stats$q3 + 1.5 * stats$iqr
  outliers <- analyzer$data[analyzer$data < lower_bound | analyzer$data > upper_bound]
  
  cat("\nüîç Outlier Analysis:\n")
  cat(sprintf("  Outliers found: %d\n", length(outliers)))
  if (length(outliers) > 0) {
    cat("  Values:", paste(sprintf("%.2f", outliers), collapse = ", "), "\n")
  }
  
  # Normality test (simplified)
  skewness <- sum((analyzer$data - stats$mean)^3) / (stats$count * stats$sd^3)
  cat("\nüìà Distribution Shape:\n")
  cat(sprintf("  Skewness: %.2f ", skewness))
  if (abs(skewness) < 0.5) {
    cat("(Approximately symmetric)\n")
  } else if (skewness > 0) {
    cat("(Right-skewed)\n")
  } else {
    cat("(Left-skewed)\n")
  }
  
  return(invisible(analyzer))
}

# Main program
cat("=== R Statistical Data Analysis ===\n\n")

# Get user input
cat("Enter your name: ")
name <- readline()
cat("Hello,", name, "! Let's analyze some data.\n\n")

# Create analyzer
analyzer <- create_analyzer(name)

# Generate sample data (normal distribution + some outliers)
set.seed(123)  # for reproducibility
sample_data <- c(
  rnorm(50, mean = 100, sd = 15),  # normal data
  rnorm(10, mean = 150, sd = 10),   # outliers on high end
  rnorm(5, mean = 50, sd = 8)       # outliers on low end
)

# Add data
analyzer <- add_data(analyzer, sample_data)

# Perform analysis
analyze(analyzer)

# Create visualization
plot(analyzer)

# Generate summary report
cat("\nüìã Summary Report for", analyzer$name, "\n")
cat("====================================\n")

# Calculate confidence interval for mean
stats <- summary(analyzer)
se <- stats$sd / sqrt(stats$count)
margin <- 1.96 * se
ci_lower <- stats$mean - margin
ci_upper <- stats$mean + margin

cat(sprintf("\nüìä 95%% Confidence Interval for Mean:\n"))
cat(sprintf("  [%.2f, %.2f]\n", ci_lower, ci_upper))

# Correlation with index (time trend)
index <- seq_along(analyzer$data)
correlation <- cor(index, analyzer$data)
cat(sprintf("\nüìà Time Trend Correlation: %.3f ", correlation))
if (abs(correlation) < 0.1) {
  cat("(No significant trend)\n")
} else if (correlation > 0) {
  cat("(Increasing trend)\n")
} else {
  cat("(Decreasing trend)\n")
}

cat("\n‚úÖ Analysis complete!\n")`,
                helloWorld: `# Hello World Program
print("Hello, World!")

name <- readline(prompt = "What's your name? ")
cat("Hello,", name, "! Welcome to R!\n")`
            }
        };

        // Piston API endpoints
        const PISTON_API = 'https://emkc.org/api/v2/piston';

        let currentMode = 'web';
        let currentLang = 'html';
        let isRunning = false;
        let editorTabs = ['main'];
        let currentTab = 'main';
        let isFullscreen = false;

        // Initialize
        window.onload = function() {
            loadLanguage('html');
            updateLanguageSelector();
            loadSavedCode();
            showToast('Welcome to CodeSphere!', 'success');
        };

        // Load saved code from localStorage
        function loadSavedCode() {
            const savedCode = localStorage.getItem('codesphere_code');
            if (savedCode) {
                document.getElementById('code-editor').value = savedCode;
            }
        }

        // Save code to localStorage
        function saveCode() {
            const code = document.getElementById('code-editor').value;
            localStorage.setItem('codesphere_code', code);
        }

        // Toast notification
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toast-icon');
            const msg = document.getElementById('toast-message');
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            icon.textContent = icons[type] || icons.info;
            msg.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function switchMode(mode, event) {
            currentMode = mode;
            
            // Update tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (event) event.target.classList.add('active');
            
            // Update language info
            updateLanguageInfo();
            
            // Update language selector
            updateLanguageSelector();
            
            // Load first language of the mode
            const firstLang = Object.keys(languages).find(key => languages[key].mode === mode);
            if (firstLang) {
                loadLanguage(firstLang);
            }
            
            // Show/hide preview
            document.getElementById('preview-section').style.display = mode === 'web' ? 'block' : 'none';
        }

        function updateLanguageInfo() {
            const infoBox = document.querySelector('.info-box p');
            if (currentMode === 'web') {
                infoBox.innerHTML = 'üí° <strong>Web Development Mode:</strong> Write HTML, CSS, and JavaScript with live preview. Perfect for building and testing web pages.';
            } else {
                infoBox.innerHTML = 'üí° <strong>Programming Languages Mode:</strong> Compile and run code using our powerful cloud compiler. Supports stdin input and shows detailed output.';
            }
        }

        function updateLanguageSelector() {
            const selector = document.getElementById('lang-selector');
            selector.innerHTML = '';
            
            Object.entries(languages).forEach(([key, lang]) => {
                if (lang.mode === currentMode) {
                    const btn = document.createElement('button');
                    btn.className = `lang-btn ${key === currentLang ? 'active' : ''}`;
                    btn.innerHTML = `${lang.icon} ${lang.name} <span style="font-size:0.8rem; opacity:0.7;">${lang.version}</span>`;
                    btn.onclick = (e) => loadLanguage(key, e);
                    selector.appendChild(btn);
                }
            });
        }

        function loadLanguage(lang, event) {
            currentLang = lang;
            
            // Update active state
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // Find and activate the correct button
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    if (btn.innerHTML.includes(languages[lang].name)) {
                        btn.classList.add('active');
                    }
                });
            }
            
            // Update editor
            document.getElementById('code-editor').value = languages[lang].sample;
            document.getElementById('editor-icon').textContent = languages[lang].icon;
            document.getElementById('editor-title').innerHTML = `${languages[lang].name} Editor`;
            document.getElementById('version-badge').textContent = languages[lang].version;
            
            // Update tab
            document.getElementById('editor-tab-icon').textContent = languages[lang].icon;
            document.getElementById('editor-tab-name').textContent = `main.${languages[lang].extension}`;
            
            // Update language info
            const infoBox = document.querySelector('.info-box p');
            infoBox.innerHTML = `üí° <strong>${languages[lang].name} ${languages[lang].version}:</strong> ${languages[lang].description}<br>
            <span style="color: #667eea;">Common Use:</span> ${languages[lang].commonUse}`;
            
            // Clear output
            document.getElementById('output').innerHTML = '// Ready to compile. Click Run to execute your code.';
            
            // Update preview if web mode
            if (languages[lang].mode === 'web') {
                runCode();
            }
            
            saveCode();
        }

        async function runCode() {
            if (isRunning) return;
            
            const code = document.getElementById('code-editor').value;
            const stdin = document.getElementById('stdin-input').value;
            const output = document.getElementById('output');
            const runBtn = document.getElementById('run-btn');
            const previewStatus = document.getElementById('preview-status');
            
            saveCode();
            
            isRunning = true;
            runBtn.innerHTML = '<span class="loading"></span> Compiling...';
            runBtn.disabled = true;
            
            if (currentMode === 'web') {
                // Web mode - live preview
                const preview = document.getElementById('preview');
                const doc = preview.contentDocument || preview.contentWindow.document;
                
                try {
                    if (currentLang === 'html') {
                        doc.open();
                        doc.write(code);
                        doc.close();
                        output.innerHTML = '<span class="output-success">‚úì HTML rendered successfully</span>';
                        previewStatus.textContent = '‚úì Live';
                    } else if (currentLang === 'css') {
                        doc.open();
                        doc.write(`
                            <!DOCTYPE html>
                            <html>
                            <head>
                                <style>${code}</style>
                            </head>
                            <body>
                                <div class="container" style="padding: 20px;">
                                    <div class="card" style="background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                                        <h1 style="margin-bottom: 20px;">CSS Preview</h1>
                                        <p style="margin-bottom: 20px;">This is a sample HTML to demonstrate your CSS styles.</p>
                                        <button class="button" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer;">Sample Button</button>
                                    </div>
                                </div>
                            </body>
                            </html>
                        `);
                        doc.close();
                        output.innerHTML = '<span class="output-success">‚úì CSS applied successfully</span>';
                        previewStatus.textContent = '‚úì Live';
                    } else if (currentLang === 'js') {
                        doc.open();
                        doc.write(`
                            <!DOCTYPE html>
                            <html>
                            <head>
                                <title>JavaScript Demo</title>
                                <style>
                                    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
                                    #app { text-align: center; }
                                    button { 
                                        background: linear-gradient(135deg, #667eea, #764ba2);
                                        color: white;
                                        border: none;
                                        padding: 12px 30px;
                                        border-radius: 25px;
                                        cursor: pointer;
                                        margin: 10px;
                                    }
                                    #output { 
                                        margin-top: 20px; 
                                        padding: 20px; 
                                        background: white; 
                                        border-radius: 10px;
                                        text-align: left;
                                    }
                                </style>
                            </head>
                            <body>
                                <div id="app"></div>
                                <div id="output"></div>
                                <script>
                                    try {
                                        // Redirect console.log to output
                                        const output = document.getElementById('output');
                                        const originalLog = console.log;
                                        console.log = function(...args) {
                                            output.innerHTML += args.join(' ') + '<br>';
                                            originalLog.apply(console, args);
                                        };
                                        
                                        ${code}
                                        
                                        if (!document.getElementById('app').innerHTML) {
                                            document.getElementById('app').innerHTML = '<h1>JavaScript Executed</h1><p>Check the output below or browser console.</p>';
                                        }
                                    } catch(e) {
                                        document.getElementById('output').innerHTML = '<span style="color:red">Error: ' + e.message + '</span>';
                                    }
                                <\/script>
                            </body>
                            </html>
                        `);
                        doc.close();
                        output.innerHTML = '<span class="output-success">‚úì JavaScript executed successfully</span>';
                        previewStatus.textContent = '‚úì Live';
                    }
                    showToast('Code executed successfully!', 'success');
                } catch (error) {
                    output.innerHTML = `<span class="output-error">‚úó Error: ${error.message}</span>`;
                    previewStatus.textContent = '‚úó Error';
                    showToast('Error executing code', 'error');
                }
            } else {
                // Language mode - use Piston API
                const lang = languages[currentLang];
                
                try {
                    const response = await fetch(`${PISTON_API}/execute`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            language: lang.language,
                            version: lang.version,
                            files: [
                                {
                                    name: `main.${lang.extension}`,
                                    content: code
                                }
                            ],
                            stdin: stdin,
                            args: [],
                            compile_timeout: 10000,
                            run_timeout: 3000
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.run && result.run.output) {
                        let outputText = result.run.output;
                        if (result.run.stderr) {
                            outputText += '\n\n' + result.run.stderr;
                        }
                        
                        // Format output
                        const lines = outputText.split('\n');
                        let formattedOutput = '';
                        lines.forEach(line => {
                            if (line.includes('Error') || line.includes('error')) {
                                formattedOutput += `<span class="output-error">${escapeHtml(line)}</span>\n`;
                            } else if (line.includes('Warning') || line.includes('warning')) {
                                formattedOutput += `<span class="output-warning">${escapeHtml(line)}</span>\n`;
                            } else {
                                formattedOutput += escapeHtml(line) + '\n';
                            }
                        });
                        
                        output.innerHTML = `<span class="output-success">‚úì Compilation successful</span>\n\n${formattedOutput}`;
                        showToast('Code compiled successfully!', 'success');
                    } else {
                        output.innerHTML = '<span class="output-warning">‚ö† No output generated</span>';
                    }
                } catch (error) {
                    output.innerHTML = `<span class="output-error">‚úó Error: ${error.message}</span>`;
                    showToast('Compilation failed', 'error');
                }
            }
            
            isRunning = false;
            runBtn.innerHTML = '<span>‚ñ∂</span> Run Code';
            runBtn.disabled = false;
        }

        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function clearCode() {
            if (confirm('Clear editor and output?')) {
                document.getElementById('code-editor').value = '';
                document.getElementById('stdin-input').value = '';
                document.getElementById('output').innerHTML = '// Ready to compile. Click Run to execute your code.';
                
                if (currentMode === 'web') {
                    document.getElementById('preview').srcdoc = '';
                    document.getElementById('preview-status').textContent = 'Ready';
                }
                
                localStorage.removeItem('codesphere_code');
                showToast('Editor cleared', 'info');
            }
        }

        function clearStdin() {
            document.getElementById('stdin-input').value = '';
            showToast('Input cleared', 'info');
        }

        function clearOutput() {
            document.getElementById('output').innerHTML = '// Output cleared';
            showToast('Output cleared', 'info');
        }

        function copyOutput() {
            const output = document.getElementById('output').innerText;
            navigator.clipboard.writeText(output).then(() => {
                showToast('Output copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy', 'error');
            });
        }

        function pasteStdin() {
            navigator.clipboard.readText().then(text => {
                document.getElementById('stdin-input').value = text;
                showToast('Pasted from clipboard', 'success');
            }).catch(() => {
                showToast('Failed to paste', 'error');
            });
        }

        function loadHelloWorld() {
            const lang = languages[currentLang];
            if (lang && lang.helloWorld) {
                document.getElementById('code-editor').value = lang.helloWorld;
                showToast(`Loaded Hello World for ${lang.name}`, 'success');
                saveCode();
                
                if (lang.mode === 'web') {
                    runCode();
                }
            }
        }

        function loadSample() {
            loadLanguage(currentLang);
            showToast('Loaded sample code', 'success');
        }

        function formatCode() {
            // Simple formatting - just trim lines
            const editor = document.getElementById('code-editor');
            const lines = editor.value.split('\n');
            const formatted = lines.map(line => line.trim()).join('\n');
            editor.value = formatted;
            showToast('Code formatted', 'success');
            saveCode();
        }

        function switchEditorView(view) {
            const toolbarBtns = document.querySelectorAll('.toolbar-btn');
            toolbarBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const editorWrapper = document.getElementById('editor-wrapper');
            const previewSection = document.getElementById('preview-section');
            
            switch(view) {
                case 'editor':
                    editorWrapper.style.display = 'block';
                    previewSection.style.display = 'none';
                    break;
                case 'preview':
                    editorWrapper.style.display = 'none';
                    previewSection.style.display = 'block';
                    break;
                case 'both':
                    editorWrapper.style.display = 'block';
                    previewSection.style.display = 'block';
                    break;
            }
        }

        function toggleFullscreen() {
            const container = document.getElementById('preview-container');
            isFullscreen = !isFullscreen;
            
            if (isFullscreen) {
                container.classList.add('fullscreen');
                document.body.style.overflow = 'hidden';
            } else {
                container.classList.remove('fullscreen');
                document.body.style.overflow = '';
            }
        }

        function refreshPreview() {
            if (currentMode === 'web') {
                runCode();
                showToast('Preview refreshed', 'success');
            }
        }

        function openPreviewInNewTab() {
            const preview = document.getElementById('preview');
            const previewDoc = preview.contentDocument || preview.contentWindow.document;
            const html = previewDoc.documentElement.outerHTML;
            
            const newWindow = window.open();
            newWindow.document.write(html);
            newWindow.document.close();
        }

        function createNewTab() {
            const tabName = `tab-${editorTabs.length + 1}`;
            editorTabs.push(tabName);
            
            const container = document.getElementById('editor-tabs-container');
            const newTab = document.createElement('button');
            newTab.className = 'editor-tab';
            newTab.setAttribute('data-tab', tabName);
            newTab.innerHTML = `
                <span>üìÑ</span>
                <span>${tabName}.${languages[currentLang].extension}</span>
                <span class="editor-tab-close" onclick="closeTab('${tabName}', event)">‚úï</span>
            `;
            newTab.onclick = () => switchTab(tabName);
            
            container.insertBefore(newTab, container.lastElementChild);
            switchTab(tabName);
        }

        function switchTab(tabName) {
            document.querySelectorAll('.editor-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            currentTab = tabName;
            
            // Load tab content from localStorage if exists
            const savedContent = localStorage.getItem(`codesphere_tab_${tabName}`);
            if (savedContent) {
                document.getElementById('code-editor').value = savedContent;
            }
        }

        function closeTab(tabName, event) {
            event.stopPropagation();
            
            if (editorTabs.length > 1) {
                const index = editorTabs.indexOf(tabName);
                editorTabs.splice(index, 1);
                
                const tabElement = document.querySelector(`[data-tab="${tabName}"]`);
                tabElement.remove();
                
                // Switch to first tab
                switchTab(editorTabs[0]);
                
                // Remove from localStorage
                localStorage.removeItem(`codesphere_tab_${tabName}`);
            } else {
                showToast('Cannot close the last tab', 'warning');
            }
        }

        // Auto-save every 30 seconds
        setInterval(saveCode, 30000);

        // Make functions global
        window.switchMode = switchMode;
        window.runCode = runCode;
        window.clearCode = clearCode;
        window.loadHelloWorld = loadHelloWorld;
        window.loadSample = loadSample;
        window.formatCode = formatCode;
        window.clearStdin = clearStdin;
        window.clearOutput = clearOutput;
        window.copyOutput = copyOutput;
        window.pasteStdin = pasteStdin;
        window.switchEditorView = switchEditorView;
        window.toggleFullscreen = toggleFullscreen;
        window.refreshPreview = refreshPreview;
        window.openPreviewInNewTab = openPreviewInNewTab;
        window.createNewTab = createNewTab;
    </script>
</body>
</html>
